---
title: "R Notebook"
output: html_notebook
---

```{r}
library(sp)
library(dplyr)
#setwd("../")
load('/Users/yeyejiang/Documents/GitHub/Spring2019-Proj2-grp11/output/nyc_nbhd.RData')
taxi1<-read.csv('/Users/yeyejiang/Desktop/taxi2016_1.csv')
taxi2<-read.csv('/Users/yeyejiang/Desktop/taxi2016_2.csv')
#nyc_neighborhoods
```

```{r}
#head(taxi1)
```

```{r}
#head(taxi2)
```

```{r}
nbhd<-function(ll){
  colnames(ll)=c('lon','lat')
  ll_spdf<-ll
  coordinates(ll_spdf)= ~lon + lat
  proj4string(ll_spdf) <- proj4string(nyc_nbhd)
  match<-over(ll_spdf, nyc_nbhd)
  return(match[,c(1,3)])
}

#taxi1
pickupnbhd1<-taxi1%>%select(PU.lon,PU.lat)%>%nbhd()
colnames(pickupnbhd1)<-c('PUnbhd','PUnbhdBorough')

dropoffnbhd1<-taxi1%>%select(DO.lon,DO.lat)%>%nbhd()
colnames(dropoffnbhd1)<-c('DOnbhd','DOnbhdBorough')

#taxi2
pickupnbhd2<-taxi2%>%select(PU.lon,PU.lat)%>%nbhd()
colnames(pickupnbhd2)<-c('PUnbhd','PUnbhdBorough')

dropoffnbhd2<-taxi2%>%select(DO.lon,DO.lat)%>%nbhd()
colnames(dropoffnbhd2)<-c('DOnbhd','DOnbhdBorough')
```

```{r}
updatetaxi1<-cbind(taxi1,pickupnbhd1,dropoffnbhd1)
updatetaxi2<-cbind(taxi2,pickupnbhd2,dropoffnbhd2)
taxidata<-rbind(updatetaxi1,updatetaxi2)
```

```{r}
setwd("../")
save(taxidata, file = "output/taxidata.RData")
```




pickupnbhd1%>%dim()
pickupnbhd2%>%dim()
dropoffnbhd1%>%dim()
dropoffnbhd2%>%dim()



